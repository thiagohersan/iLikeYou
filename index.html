<html>
<head></head>
<body>
  <div id="fb-root"></div>
  <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '256150107871644',
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    // Here we subscribe to the auth.authResponseChange JavaScript event. This event is fired
    // for any authentication related change, such as login, logout or session refresh.
    FB.Event.subscribe('auth.authResponseChange', function(response) {
      // Here we specify what we do with the response anytime this event occurs. 
      if (response.status === 'connected') {
        // The response object is returned with a status field that lets the app know the current
        // login status of the person. In this case, we're handling the situation where they 
        // have logged in to the app.
        onLogIn();
      }
    });
  };

  // Load the SDK asynchronously
  (function(d){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref);
  }(document));

  function onLogIn() {
      document.getElementById("login-button").style.display = 'none';
      FB.ui({method: 'apprequests',
        message: 'Pick person to love',
        title: 'love',
        max_recipients: 1
      }, loveCallback);
  }

  function loveCallback(pickerResponse){
    console.log("great, you picked:");
      for(var i=0; i<pickerResponse.to.length; i++) {
        var loverId = pickerResponse.to[i];
        FB.api(loverId, function(response) {
          console.log(response.name+" ("+response.id+")");
        });

        // all posts
        FB.api(loverId+"/feed", { limit: 5000 }, function(allPosts) {
          console.log(allPosts.data.length+" posts");
          for(var i=0; i<allPosts.data.length; i++){
            FB.api(allPosts.data[i].id+"/likes", 'post', function(){});
          }
        });

        // all albums/photos
        FB.api(loverId+"/albums", { limit: 5000 }, function(allAlbums) {
          console.log(allAlbums.data.length+" albums");
          for(var i=0; i<allAlbums.data.length; i++){
            // iterate through pictures
            FB.api(allAlbums.data[i].id+"/photos", { limit: 5000 }, function(albumPhotos) {
              console.log("\t"+albumPhotos.data.length+" photos");
              for(var j=0; j<albumPhotos.data.length; j++){
                FB.api(albumPhotos.data[j].id+"/likes", 'post', function(){});
              }
            });
          }
        });

        // all tagged photos
        FB.api(loverId+"/photos", { limit: 5000 }, function(allPhotos) {
          console.log(allPhotos.data.length+" tagged photos");
          for(var i=0; i<allPhotos.data.length; i++){
            FB.api(allPhotos.data[i].id+"/likes", 'post', function(){});
          }
        });
      }
  }

  </script>

  <div class="fb-login-button"
       id="login-button"
       data-width="200"
       data-height="100"
       data-max-rows="1"
       data-show-faces="false"
       data-scope="user_likes,publish_actions,publish_stream,user_likes,friends_checkins,friends_events,friends_interests,friends_likes,friends_notes,friends_photos,friends_relationship_details,friends_status,friends_videos,read_stream">
  </div>

</body>
</html>
